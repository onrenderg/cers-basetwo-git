

```mermaid
graph TD
    subgraph "App Initialization"
        A[Start] --> B(MauiProgram: Initialize App);
        B --> C(App.xaml.cs: Setup Database & Preferences);
    end

    C --> D{User Authenticated?};
    D -- No --> E[LoginPage.xaml];
    D -- Yes --> F{User Type?};

    subgraph "Get OTP Flow - LoginPage"
        E --> E1[User enters mobile number];
        E1 --> E2[btn_getotp_Clicked event handler];
        E2 --> E3[HitServices.CheckUserType_Get call];
        
        subgraph "API Call 1: Check User Type"
            E3 --> API1[POST /api/CheckUserType];
            API1 --> CTRL1[CheckUserTypeController];
            CTRL1 --> SP1[Mobile_getusertype stored procedure];
            SP1 --> RET1[Returns: UserType, Status];
            RET1 --> PREF1[Save UserType to Preferences];
        end
        
        PREF1 --> E4{UserType?};
        
        subgraph "API Call 2A: Observer Login"
            E4 -- Observer --> E5A[HitServices.observorlogin_Get];
            E5A --> API2A[POST /api/ObservorLogin];
            API2A --> CTRL2A[ObservorLoginController];
            CTRL2A --> SP2A[Mobile_CERS_ObservorLogin];
            SP2A --> RET2A[Returns: Login Status, Observer Details];
        end
        
        subgraph "API Call 2B: Candidate/Agent Login"
            E4 -- Candidate/Agent --> E5B[HitServices.userlogin_Get];
            E5B --> API2B[POST /api/UserLogin];
            API2B --> CTRL2B[UserLoginController];
            CTRL2B --> SP2B[Mobile_CERS_AppLogin];
            SP2B --> RET2B[Returns: Login Status, Nomination Status];
        end
        
        subgraph "API Call 3: Generate OTP"
            RET2A --> E6[HitServices.GetOtp];
            RET2B --> E6;
            E6 --> API3[POST /api/GetOTP];
            API3 --> CTRL3[GetOTPController];
            CTRL3 --> SP3[Mobile_CERS_SaveOtp];
            SP3 --> RET3[Returns: OTP Status, SMS Sent];
        end
        
        RET3 --> E7[Show OTP input field];
    end

    subgraph "Submit OTP Flow - LoginPage"
        E7 --> S1[User enters OTP];
        S1 --> S2[btn_submitotp_Clicked event handler];
        
        subgraph "API Call 4: Verify OTP"
            S2 --> S3[HitServices.CheckOtp];
            S3 --> API4[POST /api/CheckOtp];
            API4 --> CTRL4[CheckOtpController];
            CTRL4 --> SP4[Mobile_CERS_CheckOtp];
            SP4 --> RET4[Returns: OTP Valid, Expiry Check];
        end
        
        RET4 --> S5{OTP Valid?};
        S5 -- No --> S6[Show Error Message];
        S6 --> S1;
        
        subgraph "API Call 5A: Load Observer Data"
            S5 -- Yes & Observer --> S7A[HitServices.GetObserverCandidates];
            S7A --> API5A[POST /api/ObserverCandidates];
            API5A --> CTRL5A[ObserverCandidatesController];
            CTRL5A --> SP5A[Mobile_getobserver_candidates];
            SP5A --> RET5A[Returns: Assigned Candidates List];
        end
        
        subgraph "API Call 5B: Load Candidate Data"
            S5 -- Yes & Candidate/Agent --> S7B[Multiple HitServices calls];
            S7B --> API5B1[POST /api/ExpenseSource];
            S7B --> API5B2[POST /api/PaymentModes];
            S7B --> API5B3[POST /api/ExpenditureDetails];
            
            API5B1 --> CTRL5B1[ExpenseSourceController];
            API5B2 --> CTRL5B2[PaymentModesController];
            API5B3 --> CTRL5B3[ExpenditureDetailsController];
            
            CTRL5B1 --> SP5B1[getExpenseSource];
            CTRL5B2 --> SP5B2[Mobile_getPaymentModes];
            CTRL5B3 --> SP5B3[Mobile_getsaveData];
            
            SP5B1 --> RET5B1[Returns: Expense Categories];
            SP5B2 --> RET5B2[Returns: Payment Methods];
            SP5B3 --> RET5B3[Returns: Existing Expenditures];
        end
        
        RET5A --> F;
        RET5B3 --> F;
    end

    F -- Candidate/Agent --> K[DashboardPage.xaml];
    F -- Observer --> L[ObserverDashboardPage.xaml];

    subgraph "Dashboard Refresh Flow"
        K --> K0[OnAppearing event];
        K0 --> K01[refreshdata method];
        K01 --> K02[Multiple API calls for fresh data];
        K02 --> K03[Update UI with expenditure summaries];
    end

    subgraph "Add Expenditure Flow"
        K --> K1{User Action};
        K1 -- Add --> K2[AddExpenditureDetailsPage.xaml];
        K2 --> K2A[User fills expenditure form];
        K2A --> K2B[btn_save_Clicked event handler];
        
        subgraph "API Call 6: Save Expenditure"
            K2B --> K2C[HitServices.SaveExpenditure];
            K2C --> API6[POST /api/AddExpenditure];
            API6 --> CTRL6[AddExpenditureController];
            CTRL6 --> SP6[Mobile_saveData];
            SP6 --> RET6[Returns: Save Status, Record ID];
        end
        
        RET6 --> K2D[Navigate back to Dashboard];
        K2D --> K;
    end

    subgraph "Edit Expenditure Flow"
        K1 -- Edit --> K3[EditExpenditureDetailsPage.xaml];
        K3 --> K3A[User modifies expenditure];
        K3A --> K3B[btn_update_Clicked event handler];
        
        subgraph "API Call 7: Update Expenditure"
            K3B --> K3C[HitServices.UpdateExpenditure];
            K3C --> API7[PUT /api/UpdateExpenditure];
            API7 --> CTRL7[UpdateExpenditureController];
            CTRL7 --> SP7[Mobile_updatesaveData];
            SP7 --> RET7[Returns: Update Status];
        end
        
        RET7 --> K3D[Navigate back to Dashboard];
        K3D --> K;
    end

    subgraph "View Expenditure Flow"
        K1 -- View --> K4[ViewExpenditureDetailsPage.xaml];
        K4 --> K4A[Load expenditure details];
        
        subgraph "API Call 8: Get Remarks"
            K4A --> K4B[HitServices.GetRemarks];
            K4B --> API8[GET /api/GetRemarks];
            API8 --> CTRL8[GetRemarksController];
            CTRL8 --> SP8[Mobile_getremarks];
            SP8 --> RET8[Returns: Observer Remarks];
        end
        
        RET8 --> K4C[Display details with remarks];
        K4C --> K;
    end

    subgraph "Final Submit Flow"
        K1 -- Final Submit --> K5[btn_finalsubmit_Clicked];
        
        subgraph "API Call 9: Final Submit"
            K5 --> K5A[HitServices.FinalSubmit];
            K5A --> API9[POST /api/FinalSubmit];
            API9 --> CTRL9[FinalSubmitController];
            CTRL9 --> SP9[Mobile_finalsaveData];
            SP9 --> RET9[Returns: Final Submit Status];
        end
        
        RET9 --> K5B[Show confirmation message];
        K5B --> K;
    end

    subgraph "Settings Flow"
        K1 -- Settings --> K6[MorePage.xaml];
        K6 --> K6A{User Action};
        K6A -- Change Language --> K6B[Language selection];
        
        subgraph "API Call 10: Load Resources"
            K6B --> K6C[HitServices.LocalResources_Get];
            K6C --> API10[GET /api/LocalResources];
            API10 --> CTRL10[LocalResourcesController];
            CTRL10 --> SP10[Mobile_getLocalResources];
            SP10 --> RET10[Returns: Language Labels];
        end
        
        RET10 --> K6D[Update UI language];
        K6A -- Logout --> K6E[Clear session data];
        K6E --> E;
    end

    subgraph "Observer Dashboard Flow"
        L --> L1[Load assigned candidates];
        L1 --> L2[ObserverDashboardPage events];
        L2 --> L3{Observer Action};
        L3 -- Select Candidate --> L4[View candidate expenditures];
        
        subgraph "API Call 11: Get Candidate Data"
            L4 --> L4A[HitServices.GetCandidateData];
            L4A --> API11[GET /api/CandidateExpenditure];
            API11 --> CTRL11[CandidateExpenditureController];
            CTRL11 --> SP11[Mobile_getsaveData];
            SP11 --> RET11[Returns: Candidate Expenditure List];
        end
        
        L3 -- Add Remarks --> L5[Enter observer remarks];
        
        subgraph "API Call 12: Save Remarks"
            L5 --> L5A[HitServices.SaveRemarks];
            L5A --> API12[POST /api/SaveRemarks];
            API12 --> CTRL12[SaveRemarksController];
            CTRL12 --> SP12[Mobile_updateobserverremarks];
            SP12 --> RET12[Returns: Remarks Save Status];
        end
        
        RET11 --> L6[Display expenditure details];
        RET12 --> L6;
        L6 --> L;
    end
    ```